within eFMI_TestCases.M16_ROM.Controllers;
model PackedMatrixEqSystem
  "ROM of thermal heat transfer with the multi-dimensional arithmetics of
   'MatrixEqSystem' encapsulated in a single user-defined function. This
   encapsulation should help to avoid scalarization, but requires GALEC support
   for user-defined functions with multi-dimensional inputs and several,
   multi-dimensional outputs."
  extends PartialROMInterface;

  function rhs
    "Algorithmic function encapsulating the original equation system of
   'MatrixEqSystem'."
    input Real A_0[22,22];
    input Real A_1[22,22];
    input Real n;
    input Real E[22,22];
    input Real B[22,2];
    input Real C[12,22];
    input Real scalingFactor2D_y;
    input Real Tamb;
    input Real x[22];
    output Real der_x[22];
    output Real y[12];
  protected
    Real A[22,22];
  algorithm
    A := -1*A_0 - A_1*sqrt(n);
    /*
    Transform equation
      E*der(x) - A*x = B*{scalingFactor2D.y,Tamb}
    of 'MatrixEqSystem' to a single linear solver call:
  */
    der_x := .Modelica.Math.Matrices.solve(
      A = E,
      b = B*{scalingFactor2D_y,Tamb} + A*x);
    y := C*x;
  end rhs;

      parameter Real E[22,22] = {{9.26369682615016, 0.638012084059054, 3.67904711015134, -8.09311959606468, 0.0961145359099467, 6.45213564705067, -0.755098260215243, 3.41944009302832, 13.4705180724850, 3.76182847047704, 4.62813482537381, -3.52933776883619, 3.97533932103672, -3.84617540641972, 2.97018186640273, -5.61789798187114, -0.00214363989785760, 8.65026719123828, -7.90248079295168, 0.481159420290167, 3.00261634077773, 5.62270718286817},
{0.638012084059054, 0.185043427631117, 0.483715055007843, -1.49729296582131, 0.982236196169403, 0.708404634016946, 0.347626192295156, 0.444829060298691, 1.46676677347830, 0.588736870699821, -0.665777646512854, 1.57925941932532, 0.0673878034751662, 0.654272933776612, -0.517791813448060, -0.551033274465852, 0.351850508009648, 2.22095592661083, -1.72863696121860, -0.977167937691352, 0.811190214089234, 0.919515363399386},
{3.67904711015134, 0.483715055007843, 4.57383728430837, -6.26610200310781, 4.62790885336625, 3.10172107857643, 2.04167663371655, 1.97096009587440, 6.79809683732306, 2.07122345918364, -1.56057513535411, 4.54950101151331, 1.47130108423653, 0.0797113281857573, -0.869674794397689, -1.72940203820746, 1.22495745518672, 7.10204898752508, -8.14924120328058, -3.56962322718583, 2.05512899031034, 4.78963366001842},
{-8.09311959606468, -1.49729296582131, -6.26610200310781, 23.2742149409615, -9.16652054075364, -8.53481874027013, -6.40964034406900, -4.63977481262423, -16.7554154411538, -8.46471628510424, 2.54205124272630, -10.3964214290230, -1.31562026755896, -2.88361393770058, 2.56667998853709, 5.03903388646823, -4.55837485718204, -16.7806274956725, 18.6932731606184, 11.3593827226355, -5.24585546769945, -9.31642860515766},
{0.0961145359099467, 0.982236196169403, 4.62790885336625, -9.16652054075364, 37.4180713554443, 2.15726581429042, 16.2994197785576, 0.591006844123497, -0.101607804942062, -2.97519619643743, -23.2064874274503, 36.6231956308972, -2.61577279170470, 18.6619698894109, -15.0389338808492, 5.45477173790244, 4.28427306044500, 21.2086084610185, -18.7726689014841, -15.9057986260685, 2.43401251792132, 8.24128303817959},
{6.45213564705067, 0.708404634016946, 3.10172107857643, -8.53481874027013, 2.15726581429042, 8.44840668994888, 0.579049691112653, 3.28300871241961, 12.7152921038781, 3.87438786427955, 2.89388224213522, -0.641697801916179, 3.03185052151489, -1.77042122405273, 1.43275171502507, -4.88900075809192, 1.01688544267513, 8.85976450758083, -9.37097173504239, -1.50064537369084, 3.15666299158897, 5.96102848025286},
{-0.755098260215243, 0.347626192295156, 2.04167663371655, -6.40964034406900, 16.2994197785576, 0.579049691112653, 18.8488254859394, -4.47448497485302, -12.8108054295291, -7.71571339153514, -15.5016564764726, 26.0237785051690, -9.34833296663287, 27.0489520241536, -18.0922544871459, 4.03950466728553, 4.69267413351763, 2.24736496546807, -1.34997037688502, -13.5996187223108, -1.68031429190526, -3.76422177006731},
{3.41944009302832, 0.444829060298691, 1.97096009587440, -4.63977481262423, 0.591006844123497, 3.28300871241961, -4.47448497485302, 6.83380972015341, 18.0437270181980, 7.73865830670326, 6.75463057381513, -3.35602600832708, 7.05952885627494, -14.0688639711748, 4.60099788883221, -5.75009438459846, -0.678711449161061, 11.4914144688318, -12.5948666371040, -0.0584911747555013, 4.28699438548766, 8.51977498179725},
{13.4705180724850, 1.46676677347830, 6.79809683732306, -16.7554154411538, -0.101607804942063, 12.7152921038781, -12.8108054295291, 18.0437270181980, 53.9983450578246, 22.3668075588761, 18.3749288257678, -17.6105573659376, 19.6346400487437, -37.9711587146611, 19.2728015881773, -18.6027290710306, -1.94106896243501, 33.2488272869342, -35.6601404506253, 1.95577480009744, 12.6289013002546, 25.6999912626559},
{3.76182847047704, 0.588736870699821, 2.07122345918364, -8.46471628510424, -2.97519619643743, 3.87438786427955, -7.71571339153514, 7.73865830670326, 22.3668075588761, 11.5643150761844, 10.1332576831846, -10.2143073860704, 8.67241838131380, -20.1279644183699, 10.6514033973993, -6.98402239322298, -0.705234199459960, 12.2726989893371, -14.0225399967919, 1.40107028504748, 5.17417122906204, 10.3110426636995},
{4.62813482537381, -0.665777646512854, -1.56057513535411, 2.54205124272630, -23.2064874274503, 2.89388224213522, -15.5016564764726, 6.75463057381513, 18.3749288257678, 10.1332576831846, 61.3067419327435, -48.7314570582631, 15.3301095905967, -41.9946103698702, 23.5747349722368, -9.86690414780317, -10.7608352407171, -4.57492639299333, 20.3034118882636, 27.2483373581435, -0.751545327708533, -5.29441133986657},
{-3.52933776883618, 1.57925941932532, 4.54950101151331, -10.3964214290230, 36.6231956308972, -0.641697801916179, 26.0237785051690, -3.35602600832708, -17.6105573659375, -10.2143073860704, -48.7314570582631, 113.391343940105, -16.8165790825161, 59.4984533885456, -45.7305483563131, 13.4105794220809, 14.8084682490543, 14.8300868833777, -31.9453318377005, -41.9290792440946, 1.73543990635126, 0.545820488570836},
{3.97533932103672, 0.0673878034751662, 1.47130108423653, -1.31562026755896, -2.61577279170470, 3.03185052151489, -9.34833296663287, 7.05952885627494, 19.6346400487437, 8.67241838131380, 15.3301095905967, -16.8165790825161, 12.5768263657252, -30.1881256604786, 15.9582405816926, -4.00644209301488, -2.57562172507756, 9.59494286609388, -10.6437268179162, 9.06654418679188, 3.69640972990360, 10.3337788898081},
{-3.84617540641972, 0.654272933776612, 0.0797113281857564, -2.88361393770058, 18.6619698894109, -1.77042122405273, 27.0489520241536, -14.0688639711748, -37.9711587146611, -20.1279644183699, -41.9946103698702, 59.4984533885456, -30.1881256604786, 83.9748063941367, -46.7108235870387, 6.21654575412438, 7.25195272266226, -11.9500132500075, 16.6253815911476, -29.0842522036856, -6.21155307482625, -21.3896191907825},
{2.97018186640273, -0.517791813448060, -0.869674794397688, 2.56667998853709, -15.0389338808492, 1.43275171502507, -18.0922544871459, 4.60099788883221, 19.2728015881773, 10.6514033973993, 23.5747349722368, -45.7305483563131, 15.9582405816926, -46.7108235870387, 36.6999828171917, -3.73145571533183, -5.12830438133499, 2.59950561089791, -3.96621863253010, 22.0245464176385, 2.47656907317392, 11.0428124462172},
{-5.61789798187114, -0.551033274465852, -1.72940203820746, 5.03903388646823, 5.45477173790244, -4.88900075809192, 4.03950466728553, -5.75009438459846, -18.6027290710306, -6.98402239322298, -9.86690414780317, 13.4105794220809, -4.00644209301488, 6.21654575412439, -3.73145571533183, 11.9003513947851, 2.50500784421132, -12.9192042889604, 2.07973721031122, -2.12842697871108, -3.61149309753014, -3.96335013202031},
{-0.00214363989785760, 0.351850508009648, 1.22495745518672, -4.55837485718204, 4.28427306044500, 1.01688544267513, 4.69267413351763, -0.678711449161061, -1.94106896243501, -0.705234199459961, -10.7608352407171, 14.8084682490543, -2.57562172507756, 7.25195272266226, -5.12830438133499, 2.50500784421132, 6.21518302781746, 3.55164446089946, -10.1281548091735, -8.67984801439435, 0.990586024182796, 2.19266736019340},
{8.65026719123828, 2.22095592661083, 7.10204898752508, -16.7806274956725, 21.2086084610185, 8.85976450758083, 2.24736496546807, 11.4914144688318, 33.2488272869342, 12.2726989893371, -4.57492639299334, 14.8300868833777, 9.59494286609388, -11.9500132500075, 2.59950561089791, -12.9192042889604, 3.55164446089946, 69.3901143690710, -37.0874503050001, -6.93683891440926, 11.2903861311064, 25.0739279200512},
{-7.90248079295168, -1.72863696121860, -8.14924120328058, 18.6932731606184, -18.7726689014841, -9.37097173504239, -1.34997037688501, -12.5948666371040, -35.6601404506253, -14.0225399967919, 20.3034118882636, -31.9453318377005, -10.6437268179162, 16.6253815911476, -3.96621863253010, 2.07973721031122, -10.1281548091735, -37.0874503050000, 76.2812843196286, 21.4461898377157, -15.1567293558005, -38.0248188691143},
{0.481159420290167, -0.977167937691351, -3.56962322718583, 11.3593827226355, -15.9057986260685, -1.50064537369084, -13.5996187223108, -0.0584911747555013, 1.95577480009744, 1.40107028504748, 27.2483373581435, -41.9290792440946, 9.06654418679188, -29.0842522036856, 22.0245464176385, -2.12842697871108, -8.67984801439435, -6.93683891440926, 21.4461898377157, 29.0178117051490, -3.16738266011357, -2.55890632898603},
{3.00261634077773, 0.811190214089234, 2.05512899031034, -5.24585546769945, 2.43401251792132, 3.15666299158897, -1.68031429190526, 4.28699438548766, 12.6289013002546, 5.17417122906204, -0.751545327708535, 1.73543990635126, 3.69640972990360, -6.21155307482626, 2.47656907317392, -3.61149309753014, 0.990586024182795, 11.2903861311064, -15.1567293558005, -3.16738266011357, 5.99606754957926, 9.03548136099968},
{5.62270718286817, 0.919515363399386, 4.78963366001842, -9.31642860515766, 8.24128303817959, 5.96102848025286, -3.76422177006731, 8.51977498179725, 25.6999912626559, 10.3110426636995, -5.29441133986657, 0.545820488570836, 10.3337788898081, -21.3896191907825, 11.0428124462172, -3.96335013202031, 2.19266736019340, 25.0739279200512, -38.0248188691143, -2.55890632898604, 9.03548136099968, 32.8045748128576}};
  parameter Real A_0[22,22]= {{0.00349038055045289,0.000616738388373619,0.000546516154642147,-0.00233439011783560,0.00204416880841826,0.00305553426619378,-0.0235967069788177,-0.00336631264361289,-0.0125710737849120,0.000564445931040573,0.0123246796253061,-0.0100288682979288,-0.00152025853233014,0.00424614141400757,-0.00278720490877419,0.0107011033073374,0.00141719736525799,0.00735093827115960,-0.0100295786224890,-0.00167862273398308,-0.000661490340909788,0.00465972507089132},
{0.000616738388373552,0.698676857251845,-0.0450178097900202,0.0145802835376715,0.237041441701559,0.00838159125994689,-0.932292313546060,-0.490209154504344,-1.63903694678275,-0.387658704792887,0.538579109157917,-0.250903643347777,-0.424761061122233,1.07013387531869,-0.686505421891649,0.833993938994046,0.161665589225101,-0.139112048967760,-0.121951625371779,-0.321121035266184,-0.138598410019776,-0.167743844543448},
{0.000546516154648174,-0.0450178097900203,0.393563507222327,-0.337352302718893,-0.422367221515411,-0.0380663301701314,4.01152225239777,1.88341128943793,6.39167234760567,1.44102413394556,-2.00798908426625,0.749364274924855,1.98886294599465,-4.33071996135858,2.82169565367779,-3.02589020687220,-0.646797793947162,0.148456617166592,0.334777416528189,1.15493273638689,0.826252455260442,0.662434303751399},
{-0.00233439011783310,0.0145802835376715,-0.337352302718891,0.462304780866949,0.465581063676018,-0.0596065299211475,-4.68055017145382,-2.14916514386153,-7.37224698294540,-1.61640634259140,2.32432795638760,-0.865600471939924,-2.24688710221006,5.00778886520081,-3.30810807325359,3.40675905156093,0.671973972408242,-0.150391776483923,-0.292971807516180,-1.40727976816335,-1.06475912817318,-0.783113148068521},
{0.00204416880841898,0.237041441701559,-0.422367221515410,0.465581063676020,0.856127824666246,-0.0311230649178921,-6.23673758062561,-2.96966752081200,-10.0890188424415,-2.28132998561799,3.19249881039625,-1.24780331149786,-3.08204852455564,6.74951610150889,-4.42930864666855,4.79829047289828,0.930459091263550,-0.473891694195752,-0.528814700764672,-1.92937398321684,-1.38683586030307,-1.05726971782364},
{0.00305553426619357,0.00838159125994667,-0.0380663301701176,-0.0596065299211476,-0.0311230649178919,0.104433482521002,-0.0204655910257953,-0.0298830122167909,-0.0613043541880262,0.00281230129161842,0.0258337849554103,-0.0173893884036253,-0.00945960922923988,0.0173729259279588,0.0111877405233912,0.0152960390281620,0.0915075022640196,-0.00649316223858589,-0.0271134188714918,0.0312584767555041,-0.0350482084841908,0.0142563599201398},
{-0.0235967069788193,-0.932292313546061,4.01152225239777,-4.68055017145382,-6.23673758062560,-0.0204655910257947,59.3449752339242,27.8165738630810,94.4399603886102,21.1570415093017,-29.8989477295215,11.3445696660987,29.2119206573309,-63.6436370113117,41.5859419040016,-44.5647486804274,-8.99121089170972,2.47430571013301,5.14939152633098,17.8868259494941,12.4900794639144,9.75949901384453},
{-0.00336631264361188,-0.490209154504344,1.88341128943793,-2.14916514386153,-2.96966752081201,-0.0298830122167906,27.8165738630811,13.2152487352301,44.6055839018796,9.99293372316275,-13.9173207815262,5.23469980273631,13.7779817345067,-30.1439249512540,19.3776106058700,-21.3141367649040,-4.31086763342588,1.16501458858115,2.61156605608323,8.44404315448720,6.04908270791542,4.54703084712040},
{-0.0125710737849109,-1.63903694678275,6.39167234760567,-7.37224698294540,-10.0890188424415,-0.0613043541880261,94.4399603886102,44.6055839018796,151.347073913978,33.8455187539069,-47.6238526711629,17.9696104074774,46.5995519506058,-101.967100022557,66.5358076508468,-71.8953925987509,-14.5412604596955,4.10345352167007,8.43574927483305,28.6665354683597,20.6575734085896,15.5772168034674},
{0.000564445931040717,-0.387658704792887,1.44102413394556,-1.61640634259140,-2.28132998561800,0.00281230129161846,21.1570415093017,9.99293372316274,33.8455187539069,7.76465633836972,-10.6416834149817,3.97397442065549,10.6588872349968,-22.9243137660898,14.9748609860219,-16.4130706547088,-3.23632181455828,0.897429339681736,1.90283029832473,6.44360707681195,4.09020357980850,3.52308580186019},
{0.0123246796253062,0.538579109157917,-2.00798908426625,2.32432795638760,3.19249881039625,0.0258337849554110,-29.8989477295214,-13.9173207815262,-47.6238526711628,-10.6416834149817,15.8677801534420,-6.20292392769904,-14.6401918684106,31.7158368890827,-21.2324823845707,21.9795351898643,4.46159280547957,-1.44687523048279,-2.43129260478943,-9.03913020700625,-6.33526688251766,-4.97211074957066},
{-0.0100288682979289,-0.250903643347777,0.749364274924857,-0.865600471939922,-1.24780331149786,-0.0173893884036265,11.3445696660987,5.23469980273632,17.9696104074774,3.97397442065548,-6.20292392769904,3.08231882048608,5.32034619931334,-10.9096172317737,7.55558829110791,-6.65415241354722,-1.63270692694397,1.03649833095928,0.559808269058008,3.07964454366618,2.27460368533976,1.76470239603853},
{-0.00152025853232952,-0.424761061122233,1.98886294599465,-2.24688710221006,-3.08204852455564,-0.00945960922923951,29.2119206573309,13.7779817345067,46.5995519506058,10.6588872349968,-14.6401918684106,5.32034619931334,15.0551475353506,-32.8015577916675,21.1592584187939,-24.1007007904708,-4.43715276516985,0.786504244188090,2.75641792034291,9.30937288639175,5.68962205121121,4.84661086099670},
{0.00424614141400698,1.07013387531870,-4.33071996135858,5.00778886520081,6.74951610150889,0.0173729259279607,-63.6436370113116,-30.1439249512540,-101.967100022557,-22.9243137660898,31.7158368890827,-10.9096172317737,-32.8015577916675,75.8688144124274,-48.0597727133828,57.5963454461920,9.56550106563029,-0.638995568994092,-7.30662299460105,-21.7187470669137,-14.9793439391133,-10.7917416613105},
{-0.00278720490877402,-0.686505421891649,2.82169565367779,-3.30810807325359,-4.42930864666855,0.0111877405233916,41.5859419040016,19.3776106058700,66.5358076508468,14.9748609860219,-21.2324823845707,7.55558829110792,21.1592584187939,-48.0597727133828,31.8967453840609,-35.7975149315697,-6.18102679731723,0.960734118472709,3.95245457378380,13.8292251745995,9.45663773847345,7.19918875362377},
{0.0107011033073367,0.833993938994046,-3.02589020687220,3.40675905156094,4.79829047289828,0.0152960390281623,-44.5647486804274,-21.3141367649040,-71.8953925987509,-16.4130706547088,21.9795351898643,-6.65415241354722,-24.1007007904708,57.5963454461920,-35.7975149315697,48.5099599024267,6.91243121302530,1.70558930285427,-7.09365572733733,-16.7871716992992,-10.8129429818042,-7.28379995460362},
{0.00141719736525477,0.161665589225101,-0.646797793947157,0.671973972408244,0.930459091263550,0.0915075022640307,-8.99121089170972,-4.31086763342588,-14.5412604596955,-3.23632181455828,4.46159280547957,-1.63270692694397,-4.43715276516984,9.56550106563028,-6.18102679731723,6.91243121302530,1.74629104604343,-0.318146964285163,-0.866473310312078,-2.64662834899341,-1.97390109422705,-1.37498665439161},
{0.00735093827115981,-0.139112048967760,0.148456617166593,-0.150391776483923,-0.473891694195752,-0.00649316223858638,2.47430571013301,1.16501458858115,4.10345352167006,0.897429339681735,-1.44687523048279,1.03649833095928,0.786504244188090,-0.638995568994093,0.960734118472706,1.70558930285427,-0.318146964285163,2.03018539956559,-0.778249863448761,0.104470201882262,0.313960446553869,0.593682619075079},
{-0.0100295786224884,-0.121951625371779,0.334777416528190,-0.292971807516182,-0.528814700764673,-0.0271134188714895,5.14939152633097,2.61156605608323,8.43574927483305,1.90283029832472,-2.43129260478943,0.559808269058007,2.75641792034292,-7.30662299460105,3.95245457378381,-7.09365572733733,-0.866473310312079,-0.778249863448756,2.49829308532361,2.22005113842194,1.57757912391640,0.597508470970753},
{-0.00167862273398389,-0.321121035266184,1.15493273638689,-1.40727976816335,-1.92937398321684,0.0312584767555078,17.8868259494941,8.44404315448720,28.6665354683597,6.44360707681194,-9.03913020700626,3.07964454366618,9.30937288639174,-21.7187470669137,13.8292251745995,-16.7871716992992,-2.64662834899342,0.104470201882262,2.22005113842195,6.60783892821324,4.25246786640417,3.07494782052203},
{-0.000661490340909984,-0.138598410019776,0.826252455260442,-1.06475912817318,-1.38683586030307,-0.0350482084841910,12.4900794639143,6.04908270791541,20.6575734085896,4.09020357980850,-6.33526688251766,2.27460368533977,5.68962205121121,-14.9793439391132,9.45663773847346,-10.8129429818042,-1.97390109422705,0.313960446553868,1.57757912391640,4.25246786640416,6.57463931506111,2.09129305556627},
{0.00465972507089063,-0.167743844543448,0.662434303751399,-0.783113148068521,-1.05726971782365,0.0142563599201408,9.75949901384451,4.54703084712040,15.5772168034674,3.52308580186019,-4.97211074957066,1.76470239603853,4.84661086099670,-10.7917416613105,7.19918875362377,-7.28379995460362,-1.37498665439161,0.593682619075080,0.597508470970748,3.07494782052203,2.09129305556627,1.91325859054254}};

parameter Real A_1[22,22] = {{4.22399915064007e-10,-9.78993240531763e-08,4.84271449421965e-08,7.16831977200615e-07,-2.66791195052525e-07,8.79055422497041e-08,8.12341470031362e-07,-2.02881211714336e-07,-1.60911401529223e-06,2.93265039739651e-06,-1.42970988254655e-07,-2.53190985657820e-07,3.59425212810899e-06,1.35439638086548e-06,-1.00620807801961e-07,-1.29998988811318e-07,-2.54021228484385e-07,2.27638563696315e-08,-3.65093204658830e-07,1.67462224436071e-07,2.38409688750459e-06,-3.64972439067290e-08},
{-9.78993240531708e-08,2.33688232816074e-05,-1.30006504414019e-05,-0.000172123927608120,6.17776084922212e-05,-1.71165361402646e-05,-0.000192440067385866,4.75482794967728e-05,0.000380559149792488,-0.000696618737507767,3.27464194109127e-05,6.17970128905180e-05,-0.000848960930473906,-0.000319993171920559,2.31387416768481e-05,2.81737253216267e-05,5.72528075519299e-05,-9.02110823292172e-06,8.06693709028019e-05,-4.14270068525138e-05,-0.000565079006544058,2.18296570631294e-06},
{4.84271449421959e-08,-1.30006504414019e-05,2.85009584596332e-05,6.68045759517019e-05,-5.23019292883202e-05,-1.94663907240932e-05,0.000120647862940414,-3.07797438360319e-05,-0.000242169178758004,0.000439568787093207,-3.08162967783147e-05,-2.51776161259030e-05,0.000493465307216614,0.000184542729340164,-1.46085512146787e-05,3.16680334674831e-06,8.40424880628801e-06,1.09052678912814e-05,7.67941279121296e-06,5.81347949500472e-05,0.000334296304773781,2.14635623682398e-05},
{7.16831977200672e-07,-0.000172123927608120,6.68045759517019e-05,0.00135060592948287,-0.000389440483955866,0.000153942162327966,0.00136775655575358,-0.000330309708312395,-0.00269022823669849,0.00496220395536730,-0.000194610178437833,-0.000483757937063217,0.00609890698105984,0.00230200959914076,-0.000156689697101501,-0.000220219928647403,-0.000480749703633938,0.000108402038913569,-0.000668852711984390,0.000239550072806475,0.00406874337384248,-4.23731540091194e-05},
{-2.66791195052549e-07,6.17776084922212e-05,-5.23019292883202e-05,-0.000389440483955866,0.000218078269413378,-3.31401154178091e-05,-0.000549845534197546,0.000142959667468885,0.00110036346256925,-0.00197772839899696,0.000126216293931794,0.000139915105125521,-0.00238244825609196,-0.000894134336229338,7.33307511245653e-05,7.08292289615804e-05,0.000114513404256173,1.94284081059297e-05,0.000169726304133511,-0.000155205702855229,-0.00157399926916942,-8.13022462469380e-06},
{8.79055422496998e-08,-1.71165361402646e-05,-1.94663907240932e-05,0.000153942162327966,-3.31401154178091e-05,5.91670955847745e-05,0.000131450838237860,-3.34889912149575e-05,-0.000258968556612499,0.000465345700308016,-1.67355967768580e-05,-5.12426390791255e-05,0.000632190911776576,0.000237958029041655,-1.80171822674020e-05,-5.11852863298165e-05,-9.92014409337353e-05,-1.55874909936749e-05,-0.000141776310135762,-1.40702699454350e-05,0.000407000461863558,-4.37426915834382e-05},
{8.12341470031387e-07,-0.000192440067385866,0.000120647862940414,0.00136775655575358,-0.000549845534197546,0.000131450838237860,0.00161605396387113,-0.000404486747726728,-0.00320494924809107,0.00584069836581651,-0.000298831667528271,-0.000490794807553171,0.00709609057674622,0.00267337654330414,-0.000200131879470028,-0.000229972643791724,-0.000443316250960287,4.25509213006873e-05,-0.000630787498059360,0.000376484076070056,0.00471444691798187,-1.07952951296265e-05},
{-2.02881211714339e-07,4.75482794967728e-05,-3.07797438360319e-05,-0.000330309708312395,0.000142959667468885,-3.34889912149575e-05,-0.000404486747726728,0.000102361914681577,0.000804242772304999,-0.00145931177563098,7.92398372176053e-05,0.000118064799050047,-0.00177305504408035,-0.000666833467784398,5.11265257229582e-05,5.76552074792775e-05,0.000107570279186685,-3.33878497367342e-06,0.000154499111870705,-9.68666610053580e-05,-0.00117551754377697,2.66627970079483e-06},
{-1.60911401529229e-06,0.000380559149792488,-0.000242169178758004,-0.00269022823669849,0.00110036346256925,-0.000258968556612499,-0.00320494924809107,0.000804242772304998,0.00636056244510093,-0.0115789813630068,0.000601281708709258,0.000964346051575330,-0.0140646372713058,-0.00529478131285122,0.000398139213736402,0.000453104362945034,0.000869893250897526,-7.34486170238278e-05,0.00123993865139995,-0.000753364648215350,-0.00934071392439899,1.59704193418227e-05},
{2.93265039739651e-06,-0.000696618737507767,0.000439568787093207,0.00496220395536729,-0.00197772839899696,0.000465345700308016,0.00584069836581651,-0.00145931177563098,-0.0115789813630068,0.0211169999353364,-0.00107172575750981,-0.00178328804912821,0.0256440491250171,0.00966367140669296,-0.000720628822541369,-0.000825480308801962,-0.00159868417023296,0.000171661630249923,-0.00227084317816227,0.00136207915815512,0.0170447816145008,-2.91406111437443e-05},
{-1.42970988254657e-07,3.27464194109127e-05,-3.08162967783147e-05,-0.000194610178437833,0.000126216293931794,-1.67355967768580e-05,-0.000298831667528271,7.92398372176053e-05,0.000601281708709258,-0.00107172575750981,7.65531025885749e-05,7.09953220567356e-05,-0.00128847382512489,-0.000481011002100468,4.09717379991810e-05,3.62063229486298e-05,5.47650682772322e-05,2.07928841922902e-05,8.67102173850332e-05,-8.94351182056601e-05,-0.000849256925243398,-1.12817523800572e-05},
{-2.53190985657843e-07,6.17970128905180e-05,-2.51776161259029e-05,-0.000483757937063217,0.000139915105125521,-5.12426390791255e-05,-0.000490794807553171,0.000118064799050047,0.000964346051575330,-0.00178328804912821,7.09953220567356e-05,0.000178861178080040,-0.00218595504524568,-0.000826487245648015,5.58423242088114e-05,7.73730824170823e-05,0.000168055166065193,-3.58111279012301e-05,0.000233919641472566,-8.71931637799060e-05,-0.00146038234532604,1.61862011609455e-06},
{3.59425212810962e-06,-0.000848960930473906,0.000493465307216614,0.00609890698105984,-0.00238244825609196,0.000632190911776576,0.00709609057674622,-0.00177305504408035,-0.0140646372713058,0.0256440491250171,-0.00128847382512488,-0.00218595504524568,0.0312352219062676,0.0117687627468756,-0.000876450101952930,-0.00104663865869444,-0.00203319326379935,0.000189200557601848,-0.00288796860489857,0.00159024947638266,0.0207449283424022,-9.30550616161359e-05},
{1.35439638086559e-06,-0.000319993171920559,0.000184542729340164,0.00230200959914076,-0.000894134336229338,0.000237958029041655,0.00267337654330414,-0.000666833467784398,-0.00529478131285122,0.00966367140669297,-0.000481011002100468,-0.000826487245648015,0.0117687627468756,0.00444234974261858,-0.000331530714993280,-0.000398519307376806,-0.000766792774110392,7.35463996878235e-05,-0.00109063530073560,0.000598629127208649,0.00781771764549982,-4.61254640848834e-05},
{-1.00620807801951e-07,2.31387416768481e-05,-1.46085512146786e-05,-0.000156689697101501,7.33307511245653e-05,-1.80171822674020e-05,-0.000200131879470028,5.11265257229582e-05,0.000398139213736402,-0.000720628822541369,4.09717379991810e-05,5.58423242088114e-05,-0.000876450101952930,-0.000331530714993280,2.66292396027559e-05,3.06723254528922e-05,5.22901822056185e-05,3.33005135952059e-06,7.69875015647948e-05,-4.89530173616711e-05,-0.000579461200218102,6.25948337027017e-06},
{-1.29998988811323e-07,2.81737253216267e-05,3.16680334674831e-06,-0.000220219928647403,7.08292289615804e-05,-5.11852863298165e-05,-0.000229972643791724,5.76552074792775e-05,0.000453104362945034,-0.000825480308801962,3.62063229486298e-05,7.73730824170823e-05,-0.00104663865869444,-0.000398519307376806,3.06723254528922e-05,5.78342560968102e-05,0.000105080768953104,8.78252327096938e-06,0.000149138356373903,-2.43351645032567e-05,-0.000686001838093532,3.70945925994207e-05},
{-2.54021228484399e-07,5.72528075519299e-05,8.40424880628801e-06,-0.000480749703633939,0.000114513404256173,-9.92014409337353e-05,-0.000443316250960287,0.000107570279186685,0.000869893250897526,-0.00159868417023296,5.47650682772322e-05,0.000168055166065193,-0.00203319326379935,-0.000766792774110392,5.22901822056185e-05,0.000105080768953104,0.000221212375718688,-1.56962504244308e-05,0.000307107504295261,-3.20486314886917e-05,-0.00134237987523558,5.69955641449816e-05},
{2.27638563696284e-08,-9.02110823292171e-06,1.09052678912814e-05,0.000108402038913569,1.94284081059297e-05,-1.55874909936749e-05,4.25509213006873e-05,-3.33878497367342e-06,-7.34486170238278e-05,0.000171661630249923,2.07928841922903e-05,-3.58111279012300e-05,0.000189200557601848,7.35463996878234e-05,3.33005135952059e-06,8.78252327096938e-06,-1.56962504244308e-05,6.90918575806720e-05,-1.34946415784942e-05,7.24322716926382e-06,0.000146528597518984,8.58654200469391e-07},
{-3.65093204658835e-07,8.06693709028019e-05,7.67941279121293e-06,-0.000668852711984390,0.000169726304133511,-0.000141776310135762,-0.000630787498059360,0.000154499111870705,0.00123993865139995,-0.00227084317816227,8.67102173850332e-05,0.000233919641472566,-0.00288796860489857,-0.00109063530073560,7.69875015647948e-05,0.000149138356373903,0.000307107504295261,-1.34946415784942e-05,0.000450790158623450,-5.11217437040211e-05,-0.00190677790810908,9.34621846211981e-05},
{1.67462224436081e-07,-4.14270068525138e-05,5.81347949500472e-05,0.000239550072806475,-0.000155205702855229,-1.40702699454350e-05,0.000376484076070056,-9.68666610053580e-05,-0.000753364648215350,0.00136207915815512,-8.94351182056601e-05,-8.71931637799061e-05,0.00159024947638266,0.000598629127208650,-4.89530173616711e-05,-2.43351645032567e-05,-3.20486314886917e-05,7.24322716926382e-06,-5.11217437040211e-05,0.000140612042432085,0.00106149233554241,3.03472890779999e-05},
{2.38409688750455e-06,-0.000565079006544058,0.000334296304773781,0.00406874337384248,-0.00157399926916942,0.000407000461863558,0.00471444691798187,-0.00117551754377697,-0.00934071392439899,0.0170447816145008,-0.000849256925243398,-0.00146038234532604,0.0207449283424022,0.00781771764549982,-0.000579461200218102,-0.000686001838093532,-0.00134237987523558,0.000146528597518984,-0.00190677790810908,0.00106149233554241,0.0137869471828655,-4.99414800341607e-05},
{-3.64972439067240e-08,2.18296570631294e-06,2.14635623682398e-05,-4.23731540091194e-05,-8.13022462469380e-06,-4.37426915834382e-05,-1.07952951296265e-05,2.66627970079483e-06,1.59704193418227e-05,-2.91406111437444e-05,-1.12817523800572e-05,1.61862011609455e-06,-9.30550616161358e-05,-4.61254640848833e-05,6.25948337027016e-06,3.70945925994207e-05,5.69955641449816e-05,8.58654200469391e-07,9.34621846211981e-05,3.03472890779999e-05,-4.99414800341607e-05,0.000100834870508191}};

  parameter Real B[22,2] = {{0.0184422668310070, 0.116415227368267},
{0.00178468949378533, 0.0227113643540241},
{0.00589298338998101, 0.0105665989997382},
{-0.0340185020816958, -0.0657536446583423},
{-0.0258036882142668, 0.0159869270419513},
{0.0190584559351294, 0.104987139854951},
{0.00429380370970480, -0.924740703787163},
{-0.00226368728254659, -0.153716032434142},
{0.0153882297361728, -0.600503243844866},
{0.00847485958118647, -0.00955190029376277},
{0.0176659195695436, 0.654955380788470},
{-0.0144003411165155, -0.535211261002648},
{-0.00815451763541247, -0.0800453337357296},
{0.0231429873790822, 0.124593543130668},
{0.00603682986211513, -0.141586333275287},
{-0.0158684435907404, 0.452356365402278},
{0.00457318539387141, 0.0716583112326603},
{-0.00440475077635218, 0.383926951725132},
{0.00170323196250982, -0.518666885677971},
{-0.00598715684368338, -0.0531939395887921},
{0.00310897584046808, -0.0179959672493883},
{-0.00683831570934036, 0.271170445221004}};

  parameter Real x0[22] = {3253.30470509590, 0.651326043062204,-1.05119783502806,-0.437329246428995,-0.267203984328830,-1.28300670580913,-0.614669214398234,0.388060648078818,0.316715656264766,-0.192195698748144,-0.128662110873275,0.698288036000804,-0.223964082518306,0.712337901631017,-0.526872928777095,-0.995638411073898,-0.333310057517240,0.208643580112451,-0.609080724370543,0.117610335321009,0.215227043160613,1.03470493345951};
  parameter Real C[12,22] = {{0.0184322048246684, -0.000234317530430078, -0.00692360083548152, -0.00469969389869312, -0.00102569173708010, -0.0180694145855657, 0.000913310591229309, -0.000334872859961930, -0.00128654577078166, -0.00139469851180277, -0.000262266051051018, 0.000129536130848139, 0.000732856529793210, -0.000137941136505535, -6.36984215110415e-05, -0.000445849854420316, -0.00685269279869210, -0.000114080914581611, -0.00209175187191477, 0.000580478209051633, 0.000783190873026017, -0.000716755143468257},
{0.0184544665334304, -0.000451651986159573, 0.00622303101207765, 0.0149408951730486, -0.00188779746260089, 0.0159415245863859, 0.00233508410161518, -0.00285872830828351, -0.00236234906776918, -0.0164330659032404, -0.00439270565353276, 0.00442851114571937, 0.00784553132491755, -0.00456302531690352, 0.000483034151307910, 0.00318080160357556, 0.00549057845397736, 0.00160002590823089, -0.0121738032249534, 0.000510751880059784, 0.000214356620444002, -0.00165573131450519},
{0.0184557702647805, -0.000488591912750512, 0.00656281613345033, 0.0154628559507223, -0.00202759921871257, 0.0155421912354063, 0.00212503949925255, -0.00287512149220333, -0.00249763983396975, -0.0165521125472096, -0.00375377000850037, 0.00373765611559579, 0.00833364085403821, -0.00572558834039543, 0.00114640217591731, 0.00311359346353986, 0.00548846229993050, 0.00218331552384187, -0.0100966980263881, -0.00103110964600015, -0.000187164829779684, -0.00261706179847468},
{0.0184553888219826, 0.0201645618447559, 0.00239498286241322, 0.0245868091859528, 0.00453547868218973, 0.00884149478105968, 0.0252469231380381, 0.00158366152266227, -0.0463420647514009, 0.159962755459003, 0.0183196105944029, 0.0176863438586014, 0.229484803565955, 0.0782463568016659, -0.00211497201926469, -0.0919708572085044, 0.0107904820546869, -0.00877741223295008, -0.0540919743680912, -0.0256482473670573, -0.581926494703059, -0.00248313690972784},
{0.0184574773111689, 0.0198072996751850, 0.00242284629955138, 0.0227786378558252, 0.00517540973458593, 0.00912162916148113, 0.0245630341270144, -0.000827456775452910, -0.0461078770393614, 0.154654842689959, -0.0356300423096254, -0.0340707013095132, 0.220151175493012, 0.0823257716384639, -0.00235713519476039, -0.0994787022062307, 0.0140024694226389, -0.00709103825589777, -0.0624036422849504, -0.0304195924312720, -0.570300039041077, 0.00543949446688288},
{0.0184908751404283, -0.00775301191661265, 0.0175711137903410, 0.0569455913533655, -0.0308598545890066, 0.0110401863850293, 0.0663751165194109, -0.0197541563160685, -0.132388189525700, 0.219911342285036, -0.0142180485465776, -0.0169056812278551, 0.281797776746202, 0.0920415080305193, -0.00306939081346844, -0.000601969346523664, -0.00383855964307380, 0.00435144191546842, 0.00669794257150466, 0.0117397405180029, 0.179910923211673, 0.00102785909414598},
{0.0185354818698391, 0.000875370271816616, 0.0402425386400212, -0.120436708101534, 0.216543408488853, 0.0339548461685106, 0.128255759774953, -0.0249471094318653, -0.0533490658158439, -0.0195678776251722, 0.0901813616203169, -0.0306649286436189, 0.0181390938827192, -0.0248593323606908, 0.0159081312335105, 0.0959790131177113, 0.0146186047446455, -0.0678463576974054, -0.0433876303487254, -0.0303408403461887, -0.0112921962448061, 0.0520749399658146},
{0.0184926408538177, -0.00276308754695201, 0.0209833770528353, -0.0553908680595169, 0.0906182480821940, 0.0207662053542089, 0.0507625120900720, 0.0211946496124572, 0.0797208176196519, 0.0258967928145155, 0.0137337565880564, 0.0310279539162175, 0.0536221375381073, -0.0897417404838857, 0.0627704572218514, 0.0207719562221731, -0.00676930453264961, -0.120926504367883, -0.00795434815982902, 0.00822989603756445, -0.0121020381178968, 0.0129249227745417},
{0.0186147172498464, -0.00942880754552796, 0.0399667125129313, -0.122571688728560, 0.221767344151403, 0.0346928060677628, 0.134347559471966, -0.0385820861301910, -0.0887612848607783, -0.0327036188538612, 0.0858958331493757, -0.150004435219580, 0.0101525161694248, -0.0369583321302100, 0.0220143696945701, 0.104236856392515, 0.00672130609128853, -0.0733025922664978, -0.0313843134550034, -0.00608694031867879, -0.0757135256535883, -0.0458196489842913},
{0.0185121073864692, -0.0119917314180447, 0.0214723551294888, -0.0583352477871011, 0.0930431405586187, 0.0215678506279516, 0.0544741672542503, 0.0179360889267044, 0.0700061984786168, 0.0204499028745006, -0.0608345718558083, -0.0623281478290328, 0.0445585949826871, -0.0932991086811558, 0.0545976194169908, 0.0209779476890406, -0.00180249018561413, -0.131507429890924, -0.0272442488252402, 0.00126212078330592, -0.0653384459128847, 0.0227806946988668},
{0.0184318692438698, -0.000746421431157025, -0.00822535951203783, 0.00968727573225040, 0.0108929920253156, -0.0305330738465539, -0.00230254593548983, 0.00462064400187700, 0.0114418546242063, -0.000567811914272057, -0.00370346466586737, -0.0111345573311998, 0.000517732096183832, 0.0144643400482652, -0.00373196361751924, -0.00367196176832607, 0.0533148740006152, -0.00884808535470722, -0.00412170785275251, 0.0117664311488360, 0.000863046573444224, 0.00871193396475896},
{0.0184411489789938, 0.00175899547688291, 0.00469566709745961, -0.0316936789412283, -0.0236863176592415, 0.0193833460259650, 0.00218863779067600, 0.00249935788305152, 0.0322087444844649, 0.0151085679327459, 0.0536053931744088, 0.00378594057563124, -0.00101812158248232, 0.0162077655336667, 0.0185578139586484, -0.0222170145622461, -4.45287004757672e-06, 0.00266198131895199, 0.00214216169115803, -0.0108278502114293, 0.00465618179004961, -0.0144793262093533}};
  Real x[22];

  eFMI.Tables.CombiTable2D scalingFactor2D(table=[0,0,1200,2400,3600,4800,6000,7200,8400,9600,10800,12000;
0,0,0,0,0,0,0,0,0,0,0,0;
30,0,200,210,220,230,240,250,260,270,280,290;
60,0,490,500,510,520,530,540,550,560,570,580;
90,0,780,790,800,810,820,830,840,850,860,870;
120,0,970,980,990,1000,1010,1020,1030,1040,1050,1060;
150,0,1160,1170,1180,1190,1200,1210,1220,1230,1240,1250;
180,0,1450,1460,1470,1480,1490,1500,1510,1520,1530,1540;
210,0,1640,1650,1660,1670,1680,1690,1700,1710,1720,1730;
240,0,1730,1740,1750,1760,1770,1780,1790,1800,1810,1820;
270,0,2020,2030,2040,2050,2060,2070,2080,2090,2100,2110;
300,0,2410,2420,2430,2440,2450,2460,2470,2480,2490,2500]);

parameter Real Tamb=30;

  output Real der_x[22];

initial equation
  x = x0;

equation
  scalingFactor2D.u1 = tau;
  scalingFactor2D.u2 = n;
  der_x = der(x);
  (der_x, y) = rhs(A_0, A_1, n, E, B, C, scalingFactor2D.y, Tamb, x);
end PackedMatrixEqSystem;
